"use strict";

//Preview card

var itemsSocialMedia = document.querySelectorAll(".fill-input__placeholder");
var uploadBtn = document.querySelector(".fill-input__image");
var uploadInput = document.querySelector(".fill-input__input");
var uploadPhoto = document.querySelector(".card__image");
var uploadMiniPhoto = document.querySelector(".square__white");
var fr = new FileReader();

function reWriteData(e) {
  var fillInput = e.currentTarget;
  var targetInput = fillInput.getAttribute("data-stringer");
  var sendCont = document.querySelector("#" + targetInput);
  var itemAttribute = fillInput.getAttribute("type");
  if (itemAttribute === "number") {
    sendCont.href += fillInput.value;
  } else if (itemAttribute === "email") {
    sendCont.href += fillInput.value;
  } else if (itemAttribute === "url") {
    var scriptUrl = fillInput.value + "/";
    sendCont.href += scriptUrl;
  } else {
    sendCont.innerHTML = fillInput.value;
  }
}

//Cargar Imagen

function mostrarImagen(e) {
  var myFile = e.currentTarget.files[0];
  fr.addEventListener("load", writeImage);
  fr.readAsDataURL(myFile);
}

function writeImage() {
  var urlPhoto = "url(" + '"' + fr.result + '"' + ")";
  uploadPhoto.style.backgroundImage = urlPhoto;
  uploadMiniPhoto.style.backgroundImage = urlPhoto;
}

function clickInput() {
  uploadInput.click();
}
//console.log(uploadInput);
uploadInput.addEventListener("change", mostrarImagen);
uploadBtn.addEventListener("click", clickInput);

for (var i = 0; i < itemsSocialMedia.length; i++) {
  var targetAttribute = itemsSocialMedia[i].getAttribute("type");
  if (targetAttribute === "url") {
    itemsSocialMedia[i].addEventListener("change", reWriteData);
  } else {
    itemsSocialMedia[i].addEventListener("keyup", reWriteData);
  }
}

//habilidades
var buttonAdd = document.querySelector(".js-button-abilitiesPlus");
var buttonRemove = document.querySelectorAll(".js-button-abilitiesMinus");
var boxSkills = document.querySelectorAll(".js-ability-box");
var selectSkills = document.querySelectorAll(".js-select-abilities");


function createOption(text) {
  var option = document.createElement("option");
  var optionText = document.createTextNode(text);
  option.appendChild(optionText);
  return option;
}

function fillSelect() {
  var url =
    "https://raw.githubusercontent.com/Adalab/dorcas-s2-proyecto-data/master/skills.json";
  fetch(url)
    .then(function(response) {
      return response.json();
    })
    .then(function(json) {
      var skillList = json.skills;
      for (var i = 0; i < selectSkills.length; i++) {
        for (var j = 0; j < skillList.length; j++) {
          var newSkillsOption = createOption(skillList[j]);
          selectSkills[i].appendChild(newSkillsOption);
        }
      }
    });
}

function addSkill() {
  var boxHidden = document.querySelectorAll(".skills-hidden");

  if (boxHidden.length === 2) {
    boxSkills[1].classList.remove("skills-hidden");
  } else if (boxHidden.length === 1) {
    boxSkills[2].classList.remove("skills-hidden");
  } else {
    console.log("no hay mas habilidades que desplegar");
  }
}

function removeSkill(event) {
  var parentBox = event.currentTarget.parentElement;
  parentBox.classList.add("skills-hidden");
}

buttonAdd.addEventListener("click", addSkill);
buttonRemove[0].addEventListener("click", removeSkill);
buttonRemove[1].addEventListener("click", removeSkill);
fillSelect();

//HABILIDADES DE LA TARJETA
// var skillContainer = document.querySelector(".js-card_skills--list");

// function addSelectSkills() {
//   skillContainer.innerHTML = '';
//   console.log('contenedor',skillContainer);
//   console.log('tamaño contenedor',selectSkills.length);
//   for (var i = 0; i < selectSkills.length; i++) {
//     // if()
//     console.dir(selectSkills[i]);
//     console.log(selectSkills[i].value);
//     skillContainer.innerHTML += '<li class="skill">' + selectSkills[i].value + '</li>';
//   }

// //   var currentSkill = e.currentTarget.value;
// //   //for (var i=0; i<selectSkills.length; i++) {
// //   // console.log(selectSkills);
// //   // var x = selectSkills[i].value;
// //   // console.dir(selectSkills.value);
// //   //}
// //   var boxCardSkill = document.querySelectorAll('.skill');
// //   console.log('cuantas cajas de habiliadades hay en la tarjeta?',boxCardSkill.length);
// //   if (boxCardSkill.length < 3){
// //     skillContainer.innerHTML += '<li class="skill">' + currentSkill + '</li>';
// //   } else {
// //     console.log('No tienes tantas habilidades tio!!');
// //   }
// }

// for (var i = 0; i < selectSkills.length; i++) {
//   selectSkills[i].addEventListener('change', addSelectSkills);
// }

//colapsables
// var activableSection = document.querySelectorAll(".js-collapsible-title");
// var parent;
// var fieldset = document.querySelectorAll(".js-collapsible-visible");

//abre y cierra colapsables
//console.log(activableSection);

// function collapsibleDesign(event) {
//   parent = event.currentTarget.parentElement;
//   //console.log(parent);
//   closeCollapsibles();
//   // Si contiene la clase hidden la elimina y sino la añade
//   parent.classList.toggle("js-collapsible-visible");
// }
//
// for (var i = 0; i < activableSection.length; i++) {
//   activableSection[i].addEventListener("click", collapsibleDesign);
//   //console.log(activableSection[i]);
// }
// // un colapsable abierto cada vez
//
// function closeCollapsibles() {
//   for (var i = 0; i < fieldset.length; i++) {
//     //console.log(activableSection.length);
//     fieldset[i].classList.remove("js-collapsible-visible");
//   }
// }

//actualizar colores
var radioButtonColor = document.querySelectorAll(".color-check");
var card = document.querySelector(".jsCard");
var attri;

function selectColorCard(event) {
  //console.log("que hay en radiobut", radioButtonColor);
  card.classList.remove("green-card", "red-card", "blue-card");
  attri = event.currentTarget.getAttribute("data-dest");
  card.classList.add(attri);
}

for (var j = 0; j < radioButtonColor.length; j++) {
  radioButtonColor[j].addEventListener("click", selectColorCard);
  //console.log(radioButtonColor[j]);
}

//actualizar fuentes

var radioButtonFont = document.querySelectorAll(".font-check");
var attriFont;

function selectFontCard(event) {
  //console.log("que hay en radiobut", radioButtonFont);
  card.classList.remove("ubuntu-card", "comic-card", "montse-card");
  attriFont = event.currentTarget.getAttribute("data-font");
  card.classList.add(attriFont);
}

for (var h = 0; h < radioButtonFont.length; h++) {
  radioButtonFont[h].addEventListener("click", selectFontCard);
  //console.log(radioButtonFont[h]);
}

'use strict';

var btnCreateCard = document.querySelector('.js-btn-create-card');
var photoFileReader = new FileReader();
var form = document.querySelector('.formjs');
var responseURL = document.querySelector('.link-awesome');



function getJSONFromInputs(inputs) {
  return inputs.reduce(function (acc, val) {
    if (val.type==='radio' && val.checked===true) {
      acc[val.name] = val.value;
    }
    if ((val.nodeName !== 'BUTTON') && (val.nodeName !== 'FIELDSET') && (val.type!=='radio') ) {
      acc[val.name] = val.value;
    }
    return acc;
  }, {});
}


function sendData() {
  var inputs = Array.from(form.elements);
  var json = getJSONFromInputs(inputs);
  json.skills = ['Javascript', ' React'];
  json.photo = photoFileReader.result;
  delete json[''];
  sendRequest(json);
}

function loadPhoto() {
  var addedPhoto = document.querySelector('#add-image').files[0];
  photoFileReader.addEventListener('load', sendData);
  photoFileReader.readAsDataURL(addedPhoto);
}

function sendRequest(json) {
  fetch('https://us-central1-awesome-cards-cf6f0.cloudfunctions.net/card/', {
      method: 'POST',
      body: JSON.stringify(json),
      headers: {
        'content-type': 'application/json'
      },
    })
    .then(function(resp) {
      return resp.json();
    })
    .then(function(result) {
      showURL(result);
    })
    .catch(function(error) {
      console.log(error);
    });
}

var tweet;
function showURL(result) {
  if (result.success) {
    responseURL.innerHTML = '<a href=' + result.cardURL + '>' + result.cardURL + '</a>';
  } else {
    responseURL.innerHTML = 'ERROR:' + result.error;
  }
  tweet = result.cardURL;
}

btnCreateCard.addEventListener('click', loadPhoto);


// Compartir tarjeta en Twitter
var btnShareTwitter = document.querySelector('.btn-sharejs');
var btnToTwitter = document.querySelector('.link-awesome');
var linkToTwitter = document.querySelector('.linkTwitter');
function shareTwitter () {
  linkToTwitter.href = 'https://twitter.com/intent/tweet?url=' + tweet + '&text=Tarjeta%20de%20de%20presentacion%20con%20Awesome%20profile-cards%20(StringerThings%20-%20Sprint2%20de%20Adalab)&hashtags=WomenInTech';
}

function clickA () {
  linkToTwitter.click();
}
linkToTwitter.addEventListener('click', shareTwitter);
btnShareTwitter.addEventListener('click', clickA);

'use strict';

var lSname = document.querySelector('#nmb');
var lSjob = document.querySelector('#job');
var lSimg = document.querySelector('#add-image');
var lSmail = document.querySelector('#emailaddress');
var lSphone = document.querySelector('#phone');
var lSlinkedin = document.querySelector('#lkdn');
var lSgit = document.querySelector('#GH');

var dataCard = {};

function saveLocalStorage() {
  if (!localStorage.getItem('Business-Card')) {
  dataCard = {
    'name': '',
    'occupation': '',
    'image': '',
    'email': '',
    'telephone': '',
    'linkedin': '',
    'gitHub': '',
  }
} else {
  dataCard = JSON.parse(localStorage.getItem('Business-Card'));
  }

  dataCard.name = lSname.value;
  dataCard.occupation = lSjob.value;
  dataCard.image = lSimg.value;
  dataCard.email = lSmail.value;
  dataCard.telephone = lSphone.value;
  dataCard.linkedin = lSlinkedin.value;
  dataCard.gitHub = lSgit.value;

  localStorage.setItem('Business-Card', JSON.stringify(dataCard));
}

function recoverLocalStorage () {
  dataCard = JSON.parse(localStorage.getItem('Business-Card'));
  lSname.value = dataCard.name;
  lSjob.value = dataCard.occupation;
  uploadPhoto.style.backgroundImage = "'url("+dataCard.image+")'";
    //miniBox.style.backgroundImage = infoTarjeta.foto;
  lSmail.value = dataCard.email;
  lSphone.value = dataCard.telephone;
  lSlinkedin.value = dataCard.linkedin;
  lSgit.value = dataCard.gitHub;
}


btnCreateCard.addEventListener('click', saveLocalStorage);
//recoverLocalStorage();

'use strict';

var resetbtn = document.querySelector('.resetbutton');
var card = document.querySelector('.card');
var fullName = document.querySelector('#fullname');
var profesion = document.querySelector('#profesion');
var mobileNumber = document.querySelector('#mobile-link');
var mailAddress = document.querySelector('#mail-link');
var linkedinLink = document.querySelector('#linkedin-link');
var githubLink = document.querySelector('#github-link');

console.dir(mobileNumber)

//Objeto que traemos del saveLocalStorage
var resetCard = {};
resetCard.name = 'Nombre apellido';
resetCard.occupation = 'Profesión';
//resetCard.image = lSimg.value;
resetCard.email = '';
resetCard.telephone = '';
resetCard.linkedin = '';
resetCard.gitHub = '';
localStorage.setItem('Reset-Card', JSON.stringify(resetCard));


  function resetform() {
    document.querySelector('.form').reset();

    resetCard = JSON.parse(localStorage.getItem('Reset-Card'));
    fullName.textContent=resetCard.name;
    profesion.textContent = resetCard.occupation;
    mobileNumber.href = resetCard.email;
    mailAddress.href = resetCard.telephone;
    linkedinLink.href = resetCard.linkedin;
    githubLink.href = resetCard.gitHub;
  };

resetbtn.addEventListener('click', resetform);

//# sourceMappingURL=main.min.js.map
